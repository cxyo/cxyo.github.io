### **NMap (Zenmap是其官方图形化界面)**

**重要说明**：虽然NMap本身是国际知名的开源软件，并非“国产”，但它绝对是符合您“免费、强大”需求的最佳工具，也是在网络安全和网络管理领域**任何国籍的专家都在使用的行业标准工具**。考虑到您的核心需求是功能和效果，它是最佳选择。

---

### 1. NMap & Zenmap (强烈推荐)

- **简介**：NMap是网络发现和安全审计的“瑞士军刀”。它通过原始的IP数据包来分析网络中有哪些主机、这些主机提供什么服务、运行什么操作系统、以及使用什么类型的防火墙等。其官方图形化界面Zenmap让操作变得简单。
- **为何它能显示层级**：虽然它不会自动画出一个漂亮的拓扑图，但它能通过一系列高级扫描技术，推断出网络路径和设备类型，从而让您**手动分析出层级关系**。
- **下载地址**：[https://nmap.org/download.html](https://nmap.org/download.html)
- **适用系统**：Windows, macOS, Linux

#### 如何使用NMap进行网络设备和层级分析：

1.  **发现所有在线主机** (最基本的一步):
    
    ```bash
    nmap -sn 192.168.1.0/24
    ```
    这个命令会列出该网段内所有在线设备的IP和MAC地址。
    
2.  **识别设备类型和操作系统** (关键步骤):
    
    ```bash
    nmap -O 192.168.1.1
    ```
    对网关或特定IP进行操作系统探测。NMap有庞大的指纹库，可以识别出这是台“Cisco路由器”、“Linux服务器”还是“Windows机器”。
    
3.  **进行路由追踪，分析路径** (显示层级的核心):
    ```bash
    # 在Zenmap的"命令"框中输入
    nmap --traceroute 192.168.1.100
    ```
    这个命令会显示从你的电脑到目标IP（如`192.168.1.100`）之间经过了哪些网络节点（跳数），这直接反映了网络数据的流动路径，是分析层级的关键。

4.  **综合扫描命令** (一键获取大量信息):
    在Zenmap的“Profile”中可以选择 **“Intense scan”** 或自定义一个命令：
    ```bash
    nmap -A -T4 192.168.1.0/24
    ```
    `-A` 选项开启了操作系统和版本探测，能提供非常丰富的设备信息。

**优点**：极其强大、灵活、免费开源，是行业标准。
**缺点**：需要一定的学习成本，拓扑图需要手动分析生成。
